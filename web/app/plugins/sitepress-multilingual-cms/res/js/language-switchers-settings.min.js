var WPML_core=WPML_core||{};WPML_core.languageSwitcher=function(a,b){"use strict";var c,d,e,f,g="wpml-ls-inline-styles-additional-css",h="wpml-ls-inline-styles-dialog",i=function(){c=a("#wpml-ls-settings-form"),d=a("#wpml-ls-dialog"),e=c.add(d),k(),p(),w(),o(),j(),q(),a(document).trigger("wpml_ls_admin_loaded")},j=function(){l(),m(),n(),x(),y(),z(),C(),W(),X(),V(),Z(),D(),E(),F(),G()},k=function(){if(a("#"+g).length<1){var b=a("<style>");b.attr("id",g),b.appendTo(a("head"))}},l=function(){e.on("change",".js-wpml-ls-trigger-save",function(){$(a(this))}),e.on("keyup",".js-wpml-ls-trigger-need-save",function(){var c=a(this),d=c.closest(".js-wpml-ls-option").find(".js-wpml-ls-messages");ca(d,b.strings.leave_text_box_to_save,0,"notice")})},m=function(){e.on("click",".js-wpml-ls-toggle-slot",function(){var b=a(this),c=a(b.data("target"));c.slideToggle({complete:function(){c.is(":visible")?(b.addClass("open"),c.find(".js-wpml-ls-row-edit").trigger("click")):b.removeClass("open"),u()}})}).on("click",".js-wpml-ls-toggle-once",function(){var b=a(this).nextAll(".js-wpml-ls-toggle-target");return a(this).find("label").unwrap().find(".js-arrow-toggle").remove(),b.slideToggle(),!1})},n=function(){e.on("click.tooltip",".js-wpml-ls-tooltip-open",function(b){b.preventDefault(),H(a(this))})},o=function(){a("#wpml-ls-languages-order").sortable({stop:function(){$(a(this))}})},p=function(){d.dialog({dialogClass:"dialog-fixed otgs-ui-dialog wpml-ls-dialog",width:"90%",modal:!0,autoOpen:!1,draggable:!0,resizable:!1}).on("dialogopen",function(){a("body").css("overflow","hidden"),a(".js-wpml-ls-active-tooltip").pointer("close"),u(),v()}).on("dialogclose",function(){a("body").css("overflow",""),a(".js-wpml-ls-active-tooltip").pointer("close"),da()}),a(window).resize(t)},q=function(){var b=r();if(b){var c=a("#wpml-language-switcher-"+b.type),d=s(b);a("html, body").animate({scrollTop:c.offset().top},1,function(){var c;if(d)c=d.find(".js-wpml-ls-subform");else{var e=a("#wpml-ls-new-"+b.type+"-template");c=R(e),f=b.slug}I(c)})}},r=function(){var b=window.location.hash.substring(1).split("/"),c=null,d=b[0]||"",e=b[1]||"";return 0<=a.inArray(d,["menus","sidebars","statics"])&&(c={type:d,slug:e},parent.location.hash=""),c},s=function(b){var c="[data-item-type="+b.type+"]",d=b.slug?"[data-item-slug="+b.slug+"]":"",e=a("tr"+c+d);return 1===e.length?e:null},t=_.debounce(function(){u(),v()},200),u=function(){var b=a(window).height()-180;d.dialog("option","maxHeight",b),d.dialog("option","position",{my:"center",at:"center",of:window})},v=function(){var a=d.find(".js-wpml-ls-preview-wrapper"),b=d.width()>900,c=a.height()+200<d.height();c=c||b&&a.height()<d.height(),c?d.on("scroll.preview",function(){d.find(".js-wpml-ls-preview-wrapper").css({position:"relative",top:d.scrollTop()})}):d.off("scroll.preview").find(".js-wpml-ls-preview-wrapper").css({position:"relative",top:0})},w=function(b){b=b||c,b.find(".js-wpml-ls-colorpicker").wpColorPicker({change:function(b){var c=a(b.target).parents(".js-wpml-ls-subform");Y(c)},clear:function(b){var c=a(b.target).parents(".js-wpml-ls-subform");Y(c)}})},x=function(){a(".js-wpml-ls-dialog-close").on("click",function(a){a.preventDefault(),d.dialog("close")}),a(".js-wpml-ls-dialog-save").on("click",function(b){b.preventDefault(),a(this).prop("disabled",!0);var c=d.find(".js-wpml-ls-subform");J(c)}),a(".js-wpml-ls-open-dialog").on("click",function(b){b.preventDefault();var c,d=a(a(b.target).data("target"));c=d.hasClass("js-wpml-ls-template")?R(d):d.find(".js-wpml-ls-subform"),I(c)})},y=function(){a(".js-wpml-ls-slot-list").on("click",".js-wpml-ls-row-edit",function(b){b.preventDefault();var c=a(a(b.target).parents("tr.js-wpml-ls-row")),d=c.find(".js-wpml-ls-subform");I(d)}).on("click",".js-wpml-ls-row-remove",function(c){if(c.preventDefault(),confirm(b.strings.confirmation_item_remove)){var d=a(this).parents("tr.js-wpml-ls-row"),e=d.data("item-type");d.find(".js-wpml-ls-subform input, .js-wpml-ls-subform select").remove(),$(d,function(){d.fadeOut(800,function(){d.remove(),K(e)})})}})},z=function(){e.on("change",".js-wpml-ls-available-slots",function(){var b=a(this).val(),c=a(this).closest(".js-wpml-ls-subform"),d=c.data("item-type");a(this).removeClass("wpml-ls-required"),T(b,d)&&Q(c,b)})},A=function(b){b.find(".js-wpml-ls-colorpicker").each(function(){var b=a(this).clone(),c=a(this).parents(".js-wpml-ls-colorpicker-wrapper");c.empty().html(b)}),w(b)},B=function(a){if(f){var b='.js-wpml-ls-available-slots option[value="'+f+'"]';a.find(b).attr("selected","selected"),f=null}},C=function(){e.on("change",".js-wpml-ls-colorpicker-preset",function(){var c=a(this).val();if(c){var d=a(this).parents(".js-wpml-ls-panel-colors"),e=b.color_schemes[c].values;a.each(e,function(a,b){var c=d.find(".js-wpml-ls-color-"+a);c.attr("value",b),c.parents(".wp-picker-container").find(".wp-color-result").css("background-color",b)}),d.find(".js-wpml-ls-colorpicker").trigger("change")}})},D=function(){e.on("change","select",function(){var b=a(this).val();a("option",this).removeAttr("selected"),a('option[value="'+b+'"]',this).attr("selected","selected")})},E=function(){var b=a("#wpml-ls-refresh-on-browser-back-button");"yes"===b.val()?location.reload(!0):b.val("yes")},F=function(){c.submit(function(a){a.preventDefault(),c.find('input[name="submit_setup_wizard"]').val(1),$(c,function(){location.href=location.href.replace(/#.*/,"")})})},G=function(){a(".js-wpml-ls-preview").on("click",function(a){a.preventDefault()})},H=function(b){var c=b.data("content"),d=b.data("link-text"),e=b.data("link-url"),f=b.data("link-target");if(d.length>0){0===e.length&&(e="#");var g='target="'+f+'"';c+='<br><br><a href="'+e+'" '+g+">",c+=d,c+="</a>"}a(".js-wpml-ls-active-tooltip").pointer("close"),b.length&&c&&(b.addClass("js-wpml-ls-active-tooltip"),b.pointer({pointerClass:"js-wpml-ls-tooltip wpml-ls-tooltip",content:c,position:{edge:"bottom",align:"left"},show:function(a,b){b.pointer.css("marginLeft","-54px")},close:function(a,b){b.pointer.css("marginLeft","0")},buttons:function(b,c){var d=a('<a class="close" href="#">&nbsp;</a>');return d.bind("click.pointer",function(a){a.preventDefault(),c.element.pointer("close")})}}).pointer("open"))},I=function(a){var b=a.clone(!0);d.find(".js-wpml-ls-dialog-inner").empty().append(b),""===b.find(".js-wpml-ls-preview").html()&&Y(b),U(b),A(b),B(b),d.dialog("option","title",b.data("title")).dialog("open")},J=function(b){var c=b.clone(!0),d=b.data("item-type");if(c.find(".js-wpml-ls-preview-wrapper").css("top",0),0<=a.inArray(d,["menus","sidebars"])){var e=b.find(".js-wpml-ls-available-slots").val();T(e,d)?("undefined"==typeof c.data("origin-id")?N(c):M(c),K(d)):O(b)}else"statics"===c.data("item-type")&&L(c)},K=function(c){var d=a("#wpml-language-switcher-"+c),e=d.find(".js-wpml-ls-row").length,f=a.map(b[c],function(a,b){return b}).length;0===e?d.find(".js-wpml-ls-slot-list").fadeOut():d.find(".js-wpml-ls-slot-list").fadeIn(),e===f?d.find("button.js-wpml-ls-open-dialog").attr("disabled","disabled").siblings(".js-wpml-ls-tooltip-wrapper").removeClass("hidden"):d.find("button.js-wpml-ls-open-dialog").removeAttr("disabled").siblings(".js-wpml-ls-tooltip-wrapper").addClass("hidden")},L=function(b){var c=a("#"+b.data("origin-id")),e=b.data("item-slug");c.find(".js-wpml-ls-subform").replaceWith(b),ea("statics",e),$(c,function(){d.find(".js-wpml-ls-dialog-inner").empty(),d.dialog("close")})},M=function(b){var c=a("#"+b.data("origin-id")),e=b.data("item-type"),f=b.find(".js-wpml-ls-available-slots").val();c.find(".js-wpml-ls-subform").replaceWith(b),c.attr("id")!=="wpml-ls-"+e+"-row-"+f&&P(c,e,f),ea(e,f),$(c,function(){d.find(".js-wpml-ls-dialog-inner").empty(),d.dialog("close")})},N=function(b){var e=b.data("item-type"),f=b.find(".js-wpml-ls-available-"+e).val();Q(b,f);var g=a.trim(a("#wpml-ls-new-"+e+"-row-template").html()),h=a(a.parseHTML(g));h.find(".js-wpml-ls-subform").replaceWith(b),P(h,e,f),h.hide().appendTo(c.find("#wpml-ls-slot-list-"+e+" > tbody")).show(800),ea(e,f),$(h,function(){d.find(".js-wpml-ls-dialog-inner").empty(),d.dialog("close")})},O=function(a){a.find(".js-wpml-ls-available-slots").addClass("wpml-ls-required"),d.animate({scrollTop:0},300)},P=function(a,c,d){var e="wpml-ls-"+c+"-row-"+d,f=b[c][d].name;a.attr("id",e),a.data("item-type",c),a.find(".js-wpml-ls-subform").addBack().data("item-slug",d),a.find(".js-wpml-ls-subform").data("origin-id",e),a.find(".js-wpml-ls-row-title").html(f)},Q=function(b,c){var d="",e=b.data("item-type"),f=b.data("item-slug");b.find("input, select").each(function(b,g){d=a(g).attr("name"),"string"==typeof d&&a(g).attr("name",d.replace(e+"["+f+"]",e+"["+c+"]")),d=a(g).attr("id"),"string"==typeof d&&a(g).attr("id",d.replace(f,c))}),b.find("label").each(function(b,e){d=a(e).attr("for"),"string"==typeof d&&a(e).attr("for",d.replace(f,c))})},R=function(b){var c=a.trim(b.html()),d=a(a.parseHTML(c));return U(d),d},S=function(b){var c=[];return a("#wpml-ls-slot-list-"+b+" .js-wpml-ls-row").each(function(){c.push(a(this).data("item-slug"))}),c},T=function(c,d){var e=a.map(b[d],function(a){return"menus"===d?a.slug:a.id});return 0<=a.inArray(c,e)},U=function(b){var c=b.data("item-type"),d=S(c),e=b.data("item-slug"),f=b.find(".js-wpml-ls-available-slots option");f.each(function(){var b=a(this),c=a.inArray(b.val(),d)>=0,f=b.val();c&&e!==f?b.attr("disabled","disabled"):b.removeAttr("disabled")})},V=function(){e.on("change",'[type!="text"].js-wpml-ls-trigger-update',function(){var b=a(this).parents(".js-wpml-ls-subform");Y(b)}).on("keyup",'[type="text"].js-wpml-ls-trigger-update',function(){var b=a(this).parents(".js-wpml-ls-subform");Y(b)}).on("keyup",".js-wpml-ls-additional-css",function(){var b="wpml-ls-inline-styles-additional-css",c=a('<style id="'+b+'" type="text/css">'+a(this).val()+"</style>");a("#"+b).replaceWith(c)})},W=function(){e.on("change",".js-wpml-ls-template-selector",function(){var c=a(this).val(),d=a(this).closest(".js-wpml-ls-subform"),e=b.templates[c].force_settings;d.find(".js-wpml-ls-to-include input").prop("disabled",!1),jQuery.each(e,function(a,b){1===b?d.find(".js-wpml-ls-setting-"+a).attr("checked","checked").prop("disabled",!0):d.find(".js-wpml-ls-setting-"+a).removeAttr("checked").prop("disabled",!0)})})},X=function(){e.on("change",".js-wpml-ls-menu-is-hierarchical",function(){var b=parseInt(a(this).val()),c=a(this).closest(".js-wpml-ls-subform"),d=c.find(".js-wpml-ls-setting-display_link_for_current_lang");d.prop("disabled",!1),1===b&&d.attr("checked","checked").prop("disabled",!0)})},Y=_.debounce(function(c){a(".js-wpml-ls-dialog-save").prop("disabled",!0);var d=c.find(".js-wpml-ls-preview");if(d.length>0){ba(d);var e=aa(c);wp.ajax.send({data:{action:"wpml-ls-update-preview",nonce:b.nonce,slot_settings:e},success:function(a){d.empty(),da(a.styles),fa(a.css),ga(a.js),ca(d,a.html)},error:function(a){ca(d,a,0,"error")}})}},500),Z=function(){c.on("click",".js-wpml-ls-save-settings",function(b){b.preventDefault(),$(a(this))})},$=_.debounce(function(a,d){var e=a.closest(".js-wpml-ls-option").find(".js-wpml-ls-messages"),f=aa(c);0===e.length&&(e=a.closest(".js-wpml-ls-section").find(".js-wpml-ls-messages")),e.empty(),ba(e),wp.ajax.send({data:{action:"wpml-ls-save-settings",nonce:b.nonce,settings:f},success:function(a){ca(e,a,2500,"updated"),"function"==typeof d&&d()},error:function(a){ca(e,a,2500,"error")}})},500),aa=function(a){var b=a.find(":input:disabled").removeAttr("disabled"),c=a.find("input, select, textarea").serialize();return b.attr("disabled","disabled"),c},ba=function(b){a(".js-wpml-ls-messages").removeClass("success error").hide().empty(),b.siblings(".spinner").addClass("is-active")},ca=function(b,c,d,e){b.siblings(".spinner").removeClass("is-active"),b.removeClass("updated notice error"),e&&b.addClass(e),b.html(c).fadeIn(),d&&b.delay(d).fadeOut(),a(".js-wpml-ls-dialog-save").prop("disabled",!1)},da=function(b){if(a("#"+h).remove(),b){var c=a(a.parseHTML(b)).first();c.attr("id",h),a("#"+g).before(c)}},ea=function(b,c){var d=a("#"+h).clone(),e="wpml-ls-inline-styles-"+b+"-"+c,f=a("#"+e);d.attr("id",e),f.length?f.replaceWith(d):a("#"+g).before(d)},fa=function(b){var c,d;if("undefined"!=typeof b&&null!==b)for(c=0;c<b.length;c++)d=a('link[href="'+b[c]+'"]'),0===d.length&&(d=a("<link>"),d.attr("rel","stylesheet"),d.attr("type","text/css"),d.attr("media","all"),d.attr("href",b[c]),d.prependTo("head"))},ga=function(b){var c,d;if("undefined"!=typeof b&&null!==b)for(c=0;c<b.length;c++)d=a('script[src="'+b[c]+'"]'),0===d.length&&(d=a("<script></script>"),d.attr("type","text/javascript"),d.attr("src",b[c]),d.prependTo("head"))};return{init:i}}(jQuery,wpml_language_switcher_admin),jQuery(document).ready(function(){"use strict";WPML_core.languageSwitcher.init()});